{"title":"arm版本安装docker","date":"2023-07-13T11:00:00.000Z","date_formatted":{"ll":"2023年7月13日","L":"2023/07/13","MM-DD":"07-13"},"link":"2023/07/13/arm版本安装docker","tags":["群晖"],"categories":["学习"],"updated":"2024-10-14T02:30:23.583Z","content":"<p>本人机器本身不支持docker，为了使用镜像，在网上找了一篇教程。</p>\n<span id=\"more\"></span>\n<h2 id=\"1.-ssh执行脚本，伪装ds420j机型\">1. SSH执行脚本，伪装DS420j机型<a title=\"#1.-ssh执行脚本，伪装ds420j机型\" href=\"#1.-ssh执行脚本，伪装ds420j机型\"></a></h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. sudo -i</span><br><span class=\"line\">2. sed -i &#x27;s/218play/420j/g&#x27; /etc.defaults/synoinfo.conf</span><br><span class=\"line\">3. sed -i &#x27;s/218play/420j/g&#x27; /etc/synoinfo.conf</span><br></pre></td></tr></table></figure>\n<p>查看：控制面板–信息中心，机型是否变为：DS420j</p>\n<h2 id=\"2.-打开套件中心，手动上传安装container-manager\">2. 打开套件中心，手动上传安装Container Manager<a title=\"#2.-打开套件中心，手动上传安装container-manager\" href=\"#2.-打开套件中心，手动上传安装container-manager\"></a></h2>\n<p>最新版下载地址：<a href=\"https://imnks.com/go/aHR0cHM6Ly9hcmNoaXZlLnN5bm9sb2d5LmNvbS9kb3dubG9hZC9QYWNrYWdlL0NvbnRhaW5lck1hbmFnZXI\" target=\"_blank\">https://archive.synology.com/download/Package/ContainerManager</a></p>\n<h2 id=\"3.-套件安装完毕后，千万不要关机或者重启！！！先执行下面的恢复机型！！！\">3. 套件安装完毕后，千万不要关机或者重启！！！先执行下面的恢复机型！！！<a title=\"#3.-套件安装完毕后，千万不要关机或者重启！！！先执行下面的恢复机型！！！\" href=\"#3.-套件安装完毕后，千万不要关机或者重启！！！先执行下面的恢复机型！！！\"></a></h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. sudo -i</span><br><span class=\"line\">2. sed -i &#x27;/^exclude_model/d&#x27; /var/packages/ContainerManager/INFO</span><br><span class=\"line\">3. sed -i &#x27;s/420j/218play/g&#x27; /etc.defaults/synoinfo.conf</span><br><span class=\"line\">4. sed -i &#x27;s/420j/218play/g&#x27; /etc/synoinfo.conf</span><br></pre></td></tr></table></figure>\n<h2 id=\"4.docker部署镜像\">4.docker部署镜像<a title=\"#4.docker部署镜像\" href=\"#4.docker部署镜像\"></a></h2>\n<p><a href=\"https://github.com/xhongc/music-tag-web\">https://github.com/xhongc/music-tag-web</a></p>\n<p>这里遇到不少坑<br>\n部署完成后无法访问</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -xgt http://IP:8001/admin</span><br></pre></td></tr></table></figure>\n<p>curl: (56) Recv failure: Connection reset by peer</p>\n<p>首先进入容器确认是否部署成功</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it music_tag_web /bin/sh</span><br><span class=\"line\">netstat -ntlp</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Active Internet connections (only servers)</span><br><span class=\"line\">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class=\"line\">tcp        0      0 0.0.0.0:6379            0.0.0.0:*               LISTEN      19/redis-server *:6 </span><br><span class=\"line\">tcp        0      0 0.0.0.0:8001            0.0.0.0:*               LISTEN      286/python          </span><br><span class=\"line\">tcp        0      0 0.0.0.0:8002            0.0.0.0:*               LISTEN      10/nginx: master pr </span><br><span class=\"line\">tcp6       0      0 :::6379                 :::*                    LISTEN      19/redis-server *:6```</span><br></pre></td></tr></table></figure>\n<p>需要在容器先安装工具</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get update</span><br><span class=\"line\">apt-get install net-tools</span><br></pre></td></tr></table></figure>\n<p>使用curl命令</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -I 127.0.0.1:8001/admin</span><br></pre></td></tr></table></figure>\n<p>返回301，即发生了重定向</p>\n<p><a href=\"https://imnks.com/8157.html\" target=\"_blank\">参考</a></p>\n","prev":{"title":"MySQL沉浸式面试","link":"2023/07/26/MySQL沉浸式面试"},"next":{"title":"群晖存储空间问题","link":"2023/05/17/群晖存储空间问题"},"plink":"https://zinki.github.io/2023/07/13/arm版本安装docker/","toc":[{"id":"1.-ssh执行脚本，伪装ds420j机型","title":"1. SSH执行脚本，伪装DS420j机型","index":"1"},{"id":"2.-打开套件中心，手动上传安装container-manager","title":"2. 打开套件中心，手动上传安装Container Manager","index":"2"},{"id":"3.-套件安装完毕后，千万不要关机或者重启！！！先执行下面的恢复机型！！！","title":"3. 套件安装完毕后，千万不要关机或者重启！！！先执行下面的恢复机型！！！","index":"3"},{"id":"4.docker部署镜像","title":"4.docker部署镜像","index":"4"}]}