{"title":"X509证书解析","date":"2021-12-21T03:00:00.000Z","date_formatted":{"ll":"2021年12月21日","L":"2021/12/21","MM-DD":"12-21"},"link":"2021/12/21/X509证书解析","tags":["证书"],"categories":["工作"],"updated":"2024-10-10T08:03:05.461Z","content":"<p>X.509是密码学里公钥证书的格式标准。X.509证书已应用在包括TLS/SSL在内的众多网络协议里，同时它也用在很多非在线应用场景里，比如电子签名服务。X.509证书里含有公钥、身份信息（比如网络主机名，组织的名称或个体名称等）和签名信息（可以是证书签发机构CA的签名，也可以是自签名）<span id=\"more\"></span></p>\n<h3 id=\"x.509证书结构描述\">X.509证书结构描述<a title=\"#x.509证书结构描述\" href=\"#x.509证书结构描述\"></a></h3>\n<p>证书的结构如下所示：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Certificate</span><br><span class=\"line\"></span><br><span class=\"line\">Version</span><br><span class=\"line\">Serial Number</span><br><span class=\"line\">Algorithm ID</span><br><span class=\"line\">Issuer (CA’s name)</span><br><span class=\"line\">Validity</span><br><span class=\"line\">Not Before</span><br><span class=\"line\">Not After</span><br><span class=\"line\">Subject</span><br><span class=\"line\">Subject Public Key Info</span><br><span class=\"line\">Public Key Algorithm</span><br><span class=\"line\">Subject Public Key</span><br><span class=\"line\">Issuer Unique Identifier (Optional)</span><br><span class=\"line\">Subject Unique Identifier (Optional)</span><br><span class=\"line\">Extensions (Optional)</span><br><span class=\"line\">Certificate Signature Algorithm</span><br><span class=\"line\">Certificate Signature</span><br></pre></td></tr></table></figure>\n<p>解释：</p>\n<p>Version 版本号：标识证书的版本（版本1、版本2或是版本3）。</p>\n<p>Serial Number 序列号：标识证书的唯一整数，由证书颁发者分配的本证书的唯一标识符。</p>\n<p>Algorithm ID：算法ID: 标识证书算法</p>\n<p>Issuer (CA’s name) 颁发者：证书颁发者的可识别名（DN）。</p>\n<p>Validity 有效期：证书有效期的时间段。本字段由”Not Before”和”Not After”两项组成，它们分别由UTC时间或一般的时间表示。</p>\n<p>Subject 主体：证书拥有者的可识别名，这个字段必须是非空的，除非你在证书扩展中有别名。</p>\n<p>Subject Public Key Info 主体公钥信息： 主体的公钥（以及算法标识符）。</p>\n<p>Issuer Unique Identifier (Optional) 颁发者唯一标识符：标识符—证书颁发者的唯一标识符，仅在版本2和版本3中有要求，属于可选项。</p>\n<p>Subject Unique Identifier (Optional) 主体唯一标识符：证书拥有者的唯一标识符，仅在版本2和版本3中有要求，属于可选项。</p>\n<p>Extensions (Optional) X.509证书扩展部分</p>\n<p>Certificate Signature Algorithm 签名认证算法</p>\n<p>Certificate Signature 认证签名</p>\n<h3 id=\"证书解析\">证书解析<a title=\"#证书解析\" href=\"#证书解析\"></a></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import sun.security.x509.X500Name;</span><br><span class=\"line\">import java.io.ByteArrayInputStream;</span><br><span class=\"line\">import java.security.cert.CertificateFactory;</span><br><span class=\"line\">import java.security.cert.X509Certificate;</span><br><span class=\"line\">import org.apache.commons.net.util.Base64;</span><br><span class=\"line\"></span><br><span class=\"line\">byte[] bCertData = Base64.decodeBase64(certData);</span><br><span class=\"line\">CertificateFactory certificateFactory = CertificateFactory.getInstance(&quot;X.509&quot;, new BouncyCastleProvider());</span><br><span class=\"line\">X509Certificate certificate = (X509Certificate)certificateFactory.generateCertificate(new ByteArrayInputStream(bCertData));</span><br><span class=\"line\">X500Name x500Name = X500Name.asX500Name(certificate.getIssuerX500Principal());</span><br><span class=\"line\">Date effectedDate = certificate.getNotBefore();</span><br><span class=\"line\">Date expireDate = certificate.getNotAfter();</span><br></pre></td></tr></table></figure>\n<h3 id=\"证书序列\">证书序列<a title=\"#证书序列\" href=\"#证书序列\"></a></h3>\n<p>证书的签发者和证书主体用X.509 DN表示，DN是由RDN构成的序列。</p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th>属性类型名称</th>\n<th>含义</th>\n<th>简写</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Common Name</td>\n<td>通用名称</td>\n<td>CN</td>\n</tr>\n<tr>\n<td>Organizational Unit name</td>\n<td>机构单位名称</td>\n<td>OU</td>\n</tr>\n<tr>\n<td>Organization name</td>\n<td>机构名</td>\n<td>O</td>\n</tr>\n<tr>\n<td>Locality</td>\n<td>地理位置</td>\n<td>L</td>\n</tr>\n<tr>\n<td>State or province name</td>\n<td>州/省名</td>\n<td>S</td>\n</tr>\n<tr>\n<td>Country</td>\n<td>国名</td>\n<td>C</td>\n</tr>\n</tbody>\n</table></div></div><h3 id=\"参考\">参考<a title=\"#参考\" href=\"#参考\"></a></h3>\n<p><a href=\"https://zh.wikipedia.org/wiki/X.509\" target=\"_blank\">X.509 维基百科</a><br>\n<a href=\"https://blog.csdn.net/dickdick111/article/details/84931413\" target=\"_blank\">X.509证书的读取与解释</a></p>\n","prev":{"title":"Markdown图片解析","link":"2022/01/11/Markdown图片解析"},"next":{"title":"负载相关知识","link":"2021/11/19/负载相关知识"},"plink":"https://zinki.github.io/2021/12/21/X509证书解析/","toc":[{"id":"x.509证书结构描述","title":"X.509证书结构描述","index":"1"},{"id":"证书解析","title":"证书解析","index":"2"},{"id":"证书序列","title":"证书序列","index":"3"},{"id":"参考","title":"参考","index":"4"}]}